---
import { SITE_TITLE } from "../consts";
---

<header id="navbar" class="navbar mb-10">
  <nav class="nav-content bg-[var(--color-dark)] sm:bg-[var(--color-darkest)] pl-5 pr-2">
    <h1 class="text-lg sm:text-xl font-semibold text-white">
      <a href="/">
        <svg width="35" height="35" viewBox="0 0 270 270" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_1_16)">
            <rect x="33" y="30" width="103" height="210" fill="var(--color-secondary)"></rect>
            <circle cx="138" cy="135" r="105" fill="var(--color-secondary)"></circle>
            <path
              d="M146.67 251.62C132.27 251.62 118.95 249.28 106.71 244.6C94.65 239.74 84.12 232.99 75.12 224.35C66.3 215.71 59.37 205.54 54.33 193.84C49.47 182.14 47.04 169.36 47.04 155.5C47.04 141.64 49.47 128.86 54.33 117.16C59.37 105.46 66.39 95.29 75.39 86.65C84.39 78.01 94.92 71.35 106.98 66.67C119.22 61.81 132.54 59.38 146.94 59.38C161.34 59.38 174.48 61.63 186.36 66.13C198.42 70.63 208.68 77.47 217.14 86.65L204.72 99.34C196.8 91.42 188.07 85.75 178.53 82.33C168.99 78.91 158.73 77.2 147.75 77.2C136.05 77.2 125.25 79.18 115.35 83.14C105.63 86.92 97.08 92.41 89.7 99.61C82.5 106.63 76.83 114.91 72.69 124.45C68.73 133.81 66.75 144.16 66.75 155.5C66.75 166.66 68.73 177.01 72.69 186.55C76.83 196.09 82.5 204.46 89.7 211.66C97.08 218.68 105.63 224.17 115.35 228.13C125.25 231.91 135.96 233.8 147.48 233.8C158.28 233.8 168.45 232.18 177.99 228.94C187.71 225.7 196.62 220.21 204.72 212.47L216.06 227.59C207.06 235.51 196.53 241.54 184.47 245.68C172.41 249.64 159.81 251.62 146.67 251.62ZM196.89 225.16V155.5H216.06V227.59L196.89 225.16Z"
              fill="var(--color-light)">
            </path>
          </g>
          <defs>
            <clipPath id="clip0_1_16">
              <rect width="270" height="270" fill="white"></rect>
            </clipPath>
          </defs>
        </svg>
      </a>
    </h1>

    <div class="flex gap-4">
      <h3 class="text-xl">EDGAR SANCHEZ GIMENEZ</h3>
    </div>

    <div class="flex gap-4">
      <button id="downloadBtn" class="text-[var(--color-light)] bg-[var(--color-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-light)] text-sm font-semibold py-2 px-2 rounded-full transition">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12 15.575q-.2 0-.375-.062T11.3 15.3l-3.6-3.6q-.3-.3-.288-.7t.288-.7q.3-.3.713-.312t.712.287L11 12.15V5q0-.425.288-.712T12 4t.713.288T13 5v7.15l1.875-1.875q.3-.3.713-.288t.712.313q.275.3.288.7t-.288.7l-3.6 3.6q-.15.15-.325.213t-.375.062M6 20q-.825 0-1.412-.587T4 18v-2q0-.425.288-.712T5 15t.713.288T6 16v2h12v-2q0-.425.288-.712T19 15t.713.288T20 16v2q0 .825-.587 1.413T18 20z"/>
        </svg>
      </button>
    </div>
    
  </nav>

  <script>
    const header = document.getElementById("navbar");
    let lastScroll = 0;

    const updateNavbarPosition = () => {
      if (!header) return;
      const isMobile = window.innerWidth < 640;
      header.classList.remove("navbar-top", "navbar-bottom");
      header.classList.add(isMobile ? "navbar-bottom" : "navbar-top");
    };

    updateNavbarPosition();
    window.addEventListener("resize", updateNavbarPosition);

    window.addEventListener("scroll", () => {
      if (!header) return;
      const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
      const isMobile = window.innerWidth < 640;

      const goingDown = currentScroll > lastScroll;
      const goingUp = currentScroll < lastScroll || currentScroll <= 0;

      if (goingDown) {
        header.classList.remove("navbar-hidden", "navbar-hidden-bottom");
        header.classList.add(isMobile ? "navbar-hidden-bottom" : "navbar-hidden");
      } else if (goingUp) {
        header.classList.remove("navbar-hidden", "navbar-hidden-bottom");
      }

      lastScroll = currentScroll <= 0 ? 0 : currentScroll;
    });

    const downloadBtn = document.getElementById('downloadBtn');

    downloadBtn?.addEventListener('click', () => {
      const flash = document.createElement('div');
      flash.style.position = 'fixed';
      flash.style.top = '0';
      flash.style.left = '0';
      flash.style.width = '100%';
      flash.style.height = '100%';
      flash.style.backgroundColor = 'white';
      flash.style.opacity = '1';
      flash.style.zIndex = '9999';
      flash.style.transition = 'opacity 0.4s ease-out';
      document.body.appendChild(flash);

      setTimeout(() => {
        flash.style.opacity = '0';
      }, 100);

      setTimeout(() => {
        document.body.removeChild(flash);
        const link = document.createElement('a');
        link.href = '/CV_Edgar_Sanchez_Gimenez.pdf'; 
        link.download = 'CV_Edgar_Sanchez_Gimenez.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }, 500);
    });
  </script>
</header>
